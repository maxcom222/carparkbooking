/*!
 * ZinoUI v1.5 (http://zinoui.com)
 * Copyright 2012-2015 Dimitar Ivanov. All Rights Reserved.
 * 
 * Zino UI commercial licenses may be obtained at http://zinoui.com/license
 * If you do not own a commercial license, this file shall be governed by the
 * GNU General Public License (GPL) version 3.
 * For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
 */
(function(c,l){function h(){this._defaults={url:"upload.php",method:"PUT",name:"file",label:"Upload",data:{},multiple:!1,autoSubmit:!0,change:null,submit:null,complete:null}}function k(){this.boundary="------ZinoUI"+Math.ceil(9999999*Math.random());this.data=[]}k.prototype={append:function(b,c){this.data.push([b,c]);return this},toString:function(){var b,c,e,f=this.boundary,a=[];b=0;for(c=this.data.length;b<c;b++)a.push(["--",f,"\r\n"].join("")),this.data[b][1].name?(e=this.data[b][1],a.push(['Content-Disposition: form-data; name="',
this.data[b][0],'"; filename="',e.name,'"\r\n'].join("")),a.push(["Content-Type: ",e.type,"\r\n\r\n"].join("")),a.push([e.getAsBinary(),"\r\n"].join(""))):(a.push(['Content-Disposition: form-data; name="',this.data[b][0],'";\r\n\r\n'].join("")),a.push([this.data[b][1],"\r\n"].join("")));a.push(["--",f,"--"].join(""));return a.join("")}};h.prototype={_attachUpload:function(b,d){if(this._getInst(b))return!1;var e=c(b),f=this,a=this._newInst(e);c.extend(a.settings,this._defaults,d);e.addClass("zui-upload").hover(function(){c(this).addClass("zui-upload-hover")},
function(){c(this).removeClass("zui-upload-hover")});0<a.settings.label.length&&(a.$label=c("<span>").addClass("zui-upload-label").text(a.settings.label),a.$label.appendTo(e));a.$form=c(['<form method="',a.settings.method,'" action="',a.settings.url,'" enctype="multipart/form-data" encoding="multipart/form-data"><input name="',a.settings.name,'"',a.settings.multiple?' multiple="multiple"':"",' type="file" class="zui-upload-file" /></form>'].join(""));a.$form.addClass("zui-upload-form").bind("submit",
function(b){if(window.FormData&&window.FileList){var d=window.FormData?new FormData:new k;window.FileList&&c.each(a.$file[0].files,function(b,c){d.append(a.settings.name,c)});for(var f in a.settings.data)a.settings.data.hasOwnProperty(f)&&d.append(f,a.settings.data[f]);c.ajax({url:a.settings.url,data:d,cache:!1,contentType:!1,processData:!1,type:a.settings.method}).done(function(b){a.$file.removeAttr("disabled");e.trigger("uploadcomplete",{file:a.$file,response:b})});return!1}a.$iframe.load(function(){a.$file.removeAttr("disabled");
e.trigger("uploadcomplete",{file:a.$file,response:c(this).contents().find("html body").text()});a.$iframe.unbind()});c(this).attr("target","zui-upload-iframe-"+a.uid);b.stopPropagation()}).appendTo(e);a.$file=a.$form.find("input[type='file']");a.$file.bind("change",function(){!1!==e.trigger("uploadchange",{file:c(this)}).data("result")&&(a.fileList=this.files,a.settings.autoSubmit&&f._processUpload.call(f,b))});if(!window.FormData||!window.FileList){a.$iframe=c('<iframe name="zui-upload-iframe-'+
a.uid+'" id="zui-upload-iframe-'+a.uid+'"></iframe>').attr("src","javascript:false").addClass("zui-upload-iframe").hide().appendTo(b);for(var g in a.settings.data)a.settings.data.hasOwnProperty(g)&&c("<input>",{type:"hidden",name:g,value:a.settings.data[g]}).appendTo(a.$form)}e.bind("uploadchange",function(d,e){c(this).data("result",!0);null!==a.settings.change&&a.settings.change.call(b,d,e)}).bind("uploadsubmit",function(d,e){c(this).data("result",!0);null!==a.settings.submit&&a.settings.submit.call(b,
d,e)}).bind("uploadcomplete",function(c,d){null!==a.settings.complete&&a.settings.complete.call(b,c,d)});c.data(b,"upload",a)},_processUpload:function(b){var d=this._getInst(b);if(!d)return!1;!1!==c(b).trigger("uploadsubmit",{file:d.$file}).data("result")&&(d.$form.submit(),d.$file.attr("disabled","disabled"))},_destroyUpload:function(b){var d=this._getInst(b),e=c(b);if(!d)return!1;d.$form.remove();d.$iframe.remove();e.removeClass("zui-upload").find(".zui-upload-label").remove();c.data(b,"upload",
!1)},_optionUpload:function(b,d,e){var f=this._getInst(b);if(!f)return!1;if("string"===typeof d)if(e)f.settings[d]=e;else return f.settings[d];else"object"===typeof d&&c.extend(f.settings,d);c.data(b,"upload",f)},_newInst:function(b){return{id:b[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:b,uid:Math.floor(99999999*Math.random()),isDisabled:!1,settings:{}}},_getInst:function(b){try{return c.data(b,"upload")}catch(d){throw"Missing instance data for this upload";}}};c.fn.zinoUpload=function(b){var d=
Array.prototype.slice.call(arguments,1);return"string"==typeof b&&"isDisabled"==b||"option"==b&&2==arguments.length&&"string"==typeof arguments[1]?c.zinoUpload["_"+b+"Upload"].apply(c.zinoUpload,[this[0]].concat(d)):this.each(function(){"string"==typeof b?c.zinoUpload["_"+b+"Upload"].apply(c.zinoUpload,[this].concat(d)):c.zinoUpload._attachUpload(this,b)})};c.zinoUpload=new h;c.zinoUpload.version="1.5"})(jQuery);